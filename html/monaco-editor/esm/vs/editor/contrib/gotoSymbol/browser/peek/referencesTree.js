var __decorate=this&&this.__decorate||function(e,r,t,i){var n,a=arguments.length,s=a<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,t):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,r,t,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(s=(a<3?n(s):a>3?n(r,t,s):n(r,t))||s);return a>3&&s&&Object.defineProperty(r,t,s),s},__param=this&&this.__param||function(e,r){return function(t,i){r(t,i,e)}};import*as dom from"../../../../../base/browser/dom.js";import{CountBadge}from"../../../../../base/browser/ui/countBadge/countBadge.js";import{HighlightedLabel}from"../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js";import{IconLabel}from"../../../../../base/browser/ui/iconLabel/iconLabel.js";import{createMatches,FuzzyScore}from"../../../../../base/common/filters.js";import{getBaseLabel}from"../../../../../base/common/labels.js";import{Disposable}from"../../../../../base/common/lifecycle.js";import{basename,dirname}from"../../../../../base/common/resources.js";import{ITextModelService}from"../../../../common/services/resolverService.js";import{localize}from"../../../../../nls.js";import{IInstantiationService}from"../../../../../platform/instantiation/common/instantiation.js";import{IKeybindingService}from"../../../../../platform/keybinding/common/keybinding.js";import{ILabelService}from"../../../../../platform/label/common/label.js";import{attachBadgeStyler}from"../../../../../platform/theme/common/styler.js";import{IThemeService}from"../../../../../platform/theme/common/themeService.js";import{FileReferences,OneReference,ReferencesModel}from"../referencesModel.js";let DataSource=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof ReferencesModel||e instanceof FileReferences}getChildren(e){if(e instanceof ReferencesModel)return e.groups;if(e instanceof FileReferences)return e.resolve(this._resolverService).then((e=>e.children));throw new Error("bad tree")}};DataSource=__decorate([__param(0,ITextModelService)],DataSource);export{DataSource};export class Delegate{getHeight(){return 23}getTemplateId(e){return e instanceof FileReferences?FileReferencesRenderer.id:OneReferenceRenderer.id}}let StringRepresentationProvider=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var r;if(e instanceof OneReference){const t=null===(r=e.parent.getPreview(e))||void 0===r?void 0:r.preview(e.range);if(t)return t.value}return basename(e.uri)}};StringRepresentationProvider=__decorate([__param(0,IKeybindingService)],StringRepresentationProvider);export{StringRepresentationProvider};export class IdentityProvider{getId(e){return e instanceof OneReference?e.id:e.uri}}let FileReferencesTemplate=class extends Disposable{constructor(e,r,t){super(),this._uriLabel=r;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new IconLabel(i,{supportHighlights:!0})),this.badge=new CountBadge(dom.append(i,dom.$(".count"))),this._register(attachBadgeStyler(this.badge,t)),e.appendChild(i)}set(e,r){let t=dirname(e.uri);this.file.setLabel(getBaseLabel(e.uri),this._uriLabel.getUriLabel(t,{relative:!0}),{title:this._uriLabel.getUriLabel(e.uri),matches:r});const i=e.children.length;this.badge.setCount(i),i>1?this.badge.setTitleFormat(localize("referencesCount","{0} references",i)):this.badge.setTitleFormat(localize("referenceCount","{0} reference",i))}};FileReferencesTemplate=__decorate([__param(1,ILabelService),__param(2,IThemeService)],FileReferencesTemplate);let FileReferencesRenderer=class e{constructor(r){this._instantiationService=r,this.templateId=e.id}renderTemplate(e){return this._instantiationService.createInstance(FileReferencesTemplate,e)}renderElement(e,r,t){t.set(e.element,createMatches(e.filterData))}disposeTemplate(e){e.dispose()}};FileReferencesRenderer.id="FileReferencesRenderer",FileReferencesRenderer=__decorate([__param(0,IInstantiationService)],FileReferencesRenderer);export{FileReferencesRenderer};class OneReferenceTemplate{constructor(e){this.label=new HighlightedLabel(e)}set(e,r){var t;const i=null===(t=e.parent.getPreview(e))||void 0===t?void 0:t.preview(e.range);if(i&&i.value){const{value:e,highlight:t}=i;r&&!FuzzyScore.isDefault(r)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(e,createMatches(r))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(e,[t]))}else this.label.set(`${basename(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`)}}export class OneReferenceRenderer{constructor(){this.templateId=OneReferenceRenderer.id}renderTemplate(e){return new OneReferenceTemplate(e)}renderElement(e,r,t){t.set(e.element,e.filterData)}disposeTemplate(){}}OneReferenceRenderer.id="OneReferenceRenderer";export class AccessibilityProvider{getWidgetAriaLabel(){return localize("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}