var __awaiter=this&&this.__awaiter||function(e,o,t,r){function n(e){return e instanceof t?e:new t((function(o){o(e)}))}return new(t||(t=Promise))((function(t,i){function s(e){try{m(r.next(e))}catch(o){i(o)}}function a(e){try{m(r["throw"](e))}catch(o){i(o)}}function m(e){e.done?t(e.value):n(e.value).then(s,a)}m((r=r.apply(e,o||[])).next())}))};import{CancellationToken}from"../../../../base/common/cancellation.js";import{onUnexpectedExternalError}from"../../../../base/common/errors.js";import{assertType}from"../../../../base/common/types.js";import{URI}from"../../../../base/common/uri.js";import{Position}from"../../../common/core/position.js";import*as modes from"../../../common/languages.js";import{ITextModelService}from"../../../common/services/resolverService.js";import{CommandsRegistry}from"../../../../platform/commands/common/commands.js";import{RawContextKey}from"../../../../platform/contextkey/common/contextkey.js";export const Context={Visible:new RawContextKey("parameterHintsVisible",!1),MultipleSignatures:new RawContextKey("parameterHintsMultipleSignatures",!1)};export function provideSignatureHelp(e,o,t,r){return __awaiter(this,void 0,void 0,(function*(){const n=modes.SignatureHelpProviderRegistry.ordered(e);for(const s of n)try{const n=yield s.provideSignatureHelp(e,o,r,t);if(n)return n}catch(i){onUnexpectedExternalError(i)}}))}CommandsRegistry.registerCommand("_executeSignatureHelpProvider",((e,...o)=>__awaiter(void 0,void 0,void 0,(function*(){const[t,r,n]=o;assertType(URI.isUri(t)),assertType(Position.isIPosition(r)),assertType("string"===typeof n||!n);const i=yield e.get(ITextModelService).createModelReference(t);try{const e=yield provideSignatureHelp(i.object.textEditorModel,Position.lift(r),{triggerKind:modes.SignatureHelpTriggerKind.Invoke,isRetrigger:!1,triggerCharacter:n},CancellationToken.None);if(!e)return;return setTimeout((()=>e.dispose()),0),e.value}finally{i.dispose()}}))));