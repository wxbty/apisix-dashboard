import{EditOperation}from"../../../common/core/editOperation.js";import{Range}from"../../../common/core/range.js";export class SortLinesCommand{constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}static getCollator(){return SortLinesCommand._COLLATOR||(SortLinesCommand._COLLATOR=new Intl.Collator),SortLinesCommand._COLLATOR}getEditOperations(e,t){let n=sortLines(e,this.selection,this.descending);n&&t.addEditOperation(n.range,n.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,n){if(null===e)return!1;let r=getSortData(e,t,n);if(!r)return!1;for(let o=0,i=r.before.length;o<i;o++)if(r.before[o]!==r.after[o])return!0;return!1}}function getSortData(e,t,n){let r=t.startLineNumber,o=t.endLineNumber;if(1===t.endColumn&&o--,r>=o)return null;let i=[];for(let a=r;a<=o;a++)i.push(e.getLineContent(a));let s=i.slice(0);return s.sort(SortLinesCommand.getCollator().compare),!0===n&&(s=s.reverse()),{startLineNumber:r,endLineNumber:o,before:i,after:s}}function sortLines(e,t,n){let r=getSortData(e,t,n);return r?EditOperation.replace(new Range(r.startLineNumber,1,r.endLineNumber,e.getLineMaxColumn(r.endLineNumber)),r.after.join("\n")):null}SortLinesCommand._COLLATOR=null;