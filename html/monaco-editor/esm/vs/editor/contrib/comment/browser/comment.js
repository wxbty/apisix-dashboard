import{KeyChord}from"../../../../base/common/keyCodes.js";import{EditorAction,registerEditorAction}from"../../../browser/editorExtensions.js";import{Range}from"../../../common/core/range.js";import{EditorContextKeys}from"../../../common/editorContextKeys.js";import{ILanguageConfigurationService}from"../../../common/languages/languageConfigurationRegistry.js";import{BlockCommentCommand}from"./blockCommentCommand.js";import{LineCommentCommand}from"./lineCommentCommand.js";import*as nls from"../../../../nls.js";import{MenuId}from"../../../../platform/actions/common/actions.js";class CommentLineAction extends EditorAction{constructor(e,o){super(o),this._type=e}run(e,o){const t=e.get(ILanguageConfigurationService);if(!o.hasModel())return;const n=o.getModel(),i=[],m=n.getOptions(),r=o.getOption(19),s=o.getSelections().map(((e,o)=>({selection:e,index:o,ignoreFirstLine:!1})));s.sort(((e,o)=>Range.compareRangesUsingStarts(e.selection,o.selection)));let c=s[0];for(let d=1;d<s.length;d++){const e=s[d];c.selection.endLineNumber===e.selection.startLineNumber&&(c.index<e.index?e.ignoreFirstLine=!0:(c.ignoreFirstLine=!0,c=e))}for(const d of s)i.push(new LineCommentCommand(t,d.selection,m.tabSize,this._type,r.insertSpace,r.ignoreEmptyLines,d.ignoreFirstLine));o.pushUndoStop(),o.executeCommands(this.id,i),o.pushUndoStop()}}class ToggleCommentLineAction extends CommentLineAction{constructor(){super(0,{id:"editor.action.commentLine",label:nls.localize("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2133,weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"5_insert",title:nls.localize({key:"miToggleLineComment",comment:["&& denotes a mnemonic"]},"&&Toggle Line Comment"),order:1}})}}class AddLineCommentAction extends CommentLineAction{constructor(){super(1,{id:"editor.action.addCommentLine",label:nls.localize("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2081),weight:100}})}}class RemoveLineCommentAction extends CommentLineAction{constructor(){super(2,{id:"editor.action.removeCommentLine",label:nls.localize("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2099),weight:100}})}}class BlockCommentAction extends EditorAction{constructor(){super({id:"editor.action.blockComment",label:nls.localize("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"5_insert",title:nls.localize({key:"miToggleBlockComment",comment:["&& denotes a mnemonic"]},"Toggle &&Block Comment"),order:2}})}run(e,o){const t=e.get(ILanguageConfigurationService);if(!o.hasModel())return;const n=o.getOption(19),i=[],m=o.getSelections();for(const r of m)i.push(new BlockCommentCommand(r,n.insertSpace,t));o.pushUndoStop(),o.executeCommands(this.id,i),o.pushUndoStop()}}registerEditorAction(ToggleCommentLineAction),registerEditorAction(AddLineCommentAction),registerEditorAction(RemoveLineCommentAction),registerEditorAction(BlockCommentAction);