import"./linesDecorations.css";import{DecorationToRender,DedupOverlay}from"../glyphMargin/glyphMargin.js";export class LinesDecorationsOverlay extends DedupOverlay{constructor(e){super(),this._context=e;const t=this._context.configuration.options,n=t.get(131);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(131);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),n=[];let r=0;for(let o=0,s=t.length;o<s;o++){const e=t[o],s=e.options.linesDecorationsClassName;s&&(n[r++]=new DecorationToRender(e.range.startLineNumber,e.range.endLineNumber,s));const i=e.options.firstLineDecorationClassName;i&&(n[r++]=new DecorationToRender(e.range.startLineNumber,e.range.startLineNumber,i))}return n}prepareRender(e){const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=this._render(t,n,this._getDecorations(e)),o=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),i='" style="left:'+o+"px;width:"+s+'px;"></div>',a=[];for(let d=t;d<=n;d++){const e=d-t,n=r[e];let o="";for(let t=0,r=n.length;t<r;t++)o+='<div class="cldr '+n[t]+i;a[e]=o}this._renderResult=a}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}