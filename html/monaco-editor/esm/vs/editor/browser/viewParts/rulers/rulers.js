import"./rulers.css";import{createFastDomNode}from"../../../../base/browser/fastDomNode.js";import{ViewPart}from"../../view/viewPart.js";import{editorRuler}from"../../../common/core/editorColorRegistry.js";import{registerThemingParticipant}from"../../../../platform/theme/common/themeService.js";export class Rulers extends ViewPart{constructor(e){super(e),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(91),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(91),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:r}=this._context.model.getTextModelOptions(),o=r;let i=t-e;while(i>0){const e=createFastDomNode(document.createElement("div"));e.setClassName("view-ruler"),e.setWidth(o),this.domNode.appendChild(e),this._renderedRulers.push(e),i--}return}let r=e-t;while(r>0){const e=this._renderedRulers.pop();this.domNode.removeChild(e),r--}}render(e){this._ensureRulersCount();for(let t=0,r=this._rulers.length;t<r;t++){const r=this._renderedRulers[t],o=this._rulers[t];r.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),r.setHeight(Math.min(e.scrollHeight,1e6)),r.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}}registerThemingParticipant(((e,t)=>{const r=e.getColor(editorRuler);r&&t.addRule(`.monaco-editor .view-ruler { box-shadow: 1px 0 0 0 ${r} inset; }`)}));