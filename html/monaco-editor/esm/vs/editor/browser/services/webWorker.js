import{EditorWorkerClient}from"./editorWorkerService.js";import*as types from"../../../base/common/types.js";export function createWebWorker(e,o,r){return new MonacoWebWorkerImpl(e,o,r)}class MonacoWebWorkerImpl extends EditorWorkerClient{constructor(e,o,r){super(e,r.keepIdleModels||!1,r.label,o),this._foreignModuleId=r.moduleId,this._foreignModuleCreateData=r.createData||null,this._foreignModuleHost=r.host||null,this._foreignProxy=null}fhr(e,o){if(!this._foreignModuleHost||"function"!==typeof this._foreignModuleHost[e])return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,o))}catch(r){return Promise.reject(r)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then((e=>{const o=this._foreignModuleHost?types.getAllMethodNames(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,o).then((o=>{this._foreignModuleCreateData=null;const r=(o,r)=>e.fmr(o,r),t=(e,o)=>function(){const r=Array.prototype.slice.call(arguments,0);return o(e,r)},i={};for(const e of o)i[e]=t(e,r);return i}))}))),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then((e=>this.getProxy()))}}