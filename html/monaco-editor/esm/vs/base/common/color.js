function roundFloat(t,r){const a=Math.pow(10,r);return Math.round(t*a)/a}export class RGBA{constructor(t,r,a,e=1){this._rgbaBrand=void 0,this.r=0|Math.min(255,Math.max(0,t)),this.g=0|Math.min(255,Math.max(0,r)),this.b=0|Math.min(255,Math.max(0,a)),this.a=roundFloat(Math.max(Math.min(1,e),0),3)}static equals(t,r){return t.r===r.r&&t.g===r.g&&t.b===r.b&&t.a===r.a}}export class HSLA{constructor(t,r,a,e){this._hslaBrand=void 0,this.h=0|Math.max(Math.min(360,t),0),this.s=roundFloat(Math.max(Math.min(1,r),0),3),this.l=roundFloat(Math.max(Math.min(1,a),0),3),this.a=roundFloat(Math.max(Math.min(1,e),0),3)}static equals(t,r){return t.h===r.h&&t.s===r.s&&t.l===r.l&&t.a===r.a}static fromRGBA(t){const r=t.r/255,a=t.g/255,e=t.b/255,n=t.a,o=Math.max(r,a,e),s=Math.min(r,a,e);let h=0,i=0;const u=(s+o)/2,c=o-s;if(c>0){switch(i=Math.min(u<=.5?c/(2*u):c/(2-2*u),1),o){case r:h=(a-e)/c+(a<e?6:0);break;case a:h=(e-r)/c+2;break;case e:h=(r-a)/c+4;break}h*=60,h=Math.round(h)}return new HSLA(h,i,u,n)}static _hue2rgb(t,r,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+6*(r-t)*a:a<.5?r:a<2/3?t+(r-t)*(2/3-a)*6:t}static toRGBA(t){const r=t.h/360,{s:a,l:e,a:n}=t;let o,s,h;if(0===a)o=s=h=e;else{const t=e<.5?e*(1+a):e+a-e*a,n=2*e-t;o=HSLA._hue2rgb(n,t,r+1/3),s=HSLA._hue2rgb(n,t,r),h=HSLA._hue2rgb(n,t,r-1/3)}return new RGBA(Math.round(255*o),Math.round(255*s),Math.round(255*h),n)}}export class HSVA{constructor(t,r,a,e){this._hsvaBrand=void 0,this.h=0|Math.max(Math.min(360,t),0),this.s=roundFloat(Math.max(Math.min(1,r),0),3),this.v=roundFloat(Math.max(Math.min(1,a),0),3),this.a=roundFloat(Math.max(Math.min(1,e),0),3)}static equals(t,r){return t.h===r.h&&t.s===r.s&&t.v===r.v&&t.a===r.a}static fromRGBA(t){const r=t.r/255,a=t.g/255,e=t.b/255,n=Math.max(r,a,e),o=Math.min(r,a,e),s=n-o,h=0===n?0:s/n;let i;return i=0===s?0:n===r?((a-e)/s%6+6)%6:n===a?(e-r)/s+2:(r-a)/s+4,new HSVA(Math.round(60*i),h,n,t.a)}static toRGBA(t){const{h:r,s:a,v:e,a:n}=t,o=e*a,s=o*(1-Math.abs(r/60%2-1)),h=e-o;let[i,u,c]=[0,0,0];return r<60?(i=o,u=s):r<120?(i=s,u=o):r<180?(u=o,c=s):r<240?(u=s,c=o):r<300?(i=s,c=o):r<=360&&(i=o,c=s),i=Math.round(255*(i+h)),u=Math.round(255*(u+h)),c=Math.round(255*(c+h)),new RGBA(i,u,c,n)}}export class Color{constructor(t){if(!t)throw new Error("Color needs a value");if(t instanceof RGBA)this.rgba=t;else if(t instanceof HSLA)this._hsla=t,this.rgba=HSLA.toRGBA(t);else{if(!(t instanceof HSVA))throw new Error("Invalid color ctor argument");this._hsva=t,this.rgba=HSVA.toRGBA(t)}}static fromHex(t){return Color.Format.CSS.parseHex(t)||Color.red}get hsla(){return this._hsla?this._hsla:HSLA.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:HSVA.fromRGBA(this.rgba)}equals(t){return!!t&&RGBA.equals(this.rgba,t.rgba)&&HSLA.equals(this.hsla,t.hsla)&&HSVA.equals(this.hsva,t.hsva)}getRelativeLuminance(){const t=Color._relativeLuminanceForComponent(this.rgba.r),r=Color._relativeLuminanceForComponent(this.rgba.g),a=Color._relativeLuminanceForComponent(this.rgba.b),e=.2126*t+.7152*r+.0722*a;return roundFloat(e,4)}static _relativeLuminanceForComponent(t){const r=t/255;return r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}isLighter(){const t=(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3;return t>=128}isLighterThan(t){const r=this.getRelativeLuminance(),a=t.getRelativeLuminance();return r>a}isDarkerThan(t){const r=this.getRelativeLuminance(),a=t.getRelativeLuminance();return r<a}lighten(t){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*t,this.hsla.a))}darken(t){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*t,this.hsla.a))}transparent(t){const{r:r,g:a,b:e,a:n}=this.rgba;return new Color(new RGBA(r,a,e,n*t))}isTransparent(){return 0===this.rgba.a}isOpaque(){return 1===this.rgba.a}opposite(){return new Color(new RGBA(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}toString(){return this._toString||(this._toString=Color.Format.CSS.format(this)),this._toString}static getLighterColor(t,r,a){if(t.isLighterThan(r))return t;a=a||.5;const e=t.getRelativeLuminance(),n=r.getRelativeLuminance();return a=a*(n-e)/n,t.lighten(a)}static getDarkerColor(t,r,a){if(t.isDarkerThan(r))return t;a=a||.5;const e=t.getRelativeLuminance(),n=r.getRelativeLuminance();return a=a*(e-n)/e,t.darken(a)}}Color.white=new Color(new RGBA(255,255,255,1)),Color.black=new Color(new RGBA(0,0,0,1)),Color.red=new Color(new RGBA(255,0,0,1)),Color.blue=new Color(new RGBA(0,0,255,1)),Color.green=new Color(new RGBA(0,255,0,1)),Color.cyan=new Color(new RGBA(0,255,255,1)),Color.lightgrey=new Color(new RGBA(211,211,211,1)),Color.transparent=new Color(new RGBA(0,0,0,0)),function(t){let r;(function(r){let a;(function(r){function a(r){return 1===r.rgba.a?`rgb(${r.rgba.r}, ${r.rgba.g}, ${r.rgba.b})`:t.Format.CSS.formatRGBA(r)}function e(t){return`rgba(${t.rgba.r}, ${t.rgba.g}, ${t.rgba.b}, ${+t.rgba.a.toFixed(2)})`}function n(r){return 1===r.hsla.a?`hsl(${r.hsla.h}, ${(100*r.hsla.s).toFixed(2)}%, ${(100*r.hsla.l).toFixed(2)}%)`:t.Format.CSS.formatHSLA(r)}function o(t){return`hsla(${t.hsla.h}, ${(100*t.hsla.s).toFixed(2)}%, ${(100*t.hsla.l).toFixed(2)}%, ${t.hsla.a.toFixed(2)})`}function s(t){const r=t.toString(16);return 2!==r.length?"0"+r:r}function h(t){return`#${s(t.rgba.r)}${s(t.rgba.g)}${s(t.rgba.b)}`}function i(r,a=!1){return a&&1===r.rgba.a?t.Format.CSS.formatHex(r):`#${s(r.rgba.r)}${s(r.rgba.g)}${s(r.rgba.b)}${s(Math.round(255*r.rgba.a))}`}function u(r){return r.isOpaque()?t.Format.CSS.formatHex(r):t.Format.CSS.formatRGBA(r)}function c(r){const a=r.length;if(0===a)return null;if(35!==r.charCodeAt(0))return null;if(7===a){const a=16*l(r.charCodeAt(1))+l(r.charCodeAt(2)),e=16*l(r.charCodeAt(3))+l(r.charCodeAt(4)),n=16*l(r.charCodeAt(5))+l(r.charCodeAt(6));return new t(new RGBA(a,e,n,1))}if(9===a){const a=16*l(r.charCodeAt(1))+l(r.charCodeAt(2)),e=16*l(r.charCodeAt(3))+l(r.charCodeAt(4)),n=16*l(r.charCodeAt(5))+l(r.charCodeAt(6)),o=16*l(r.charCodeAt(7))+l(r.charCodeAt(8));return new t(new RGBA(a,e,n,o/255))}if(4===a){const a=l(r.charCodeAt(1)),e=l(r.charCodeAt(2)),n=l(r.charCodeAt(3));return new t(new RGBA(16*a+a,16*e+e,16*n+n))}if(5===a){const a=l(r.charCodeAt(1)),e=l(r.charCodeAt(2)),n=l(r.charCodeAt(3)),o=l(r.charCodeAt(4));return new t(new RGBA(16*a+a,16*e+e,16*n+n,(16*o+o)/255))}return null}function l(t){switch(t){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}r.formatRGB=a,r.formatRGBA=e,r.formatHSL=n,r.formatHSLA=o,r.formatHex=h,r.formatHexA=i,r.format=u,r.parseHex=c})(a=r.CSS||(r.CSS={}))})(r=t.Format||(t.Format={}))}(Color||(Color={}));