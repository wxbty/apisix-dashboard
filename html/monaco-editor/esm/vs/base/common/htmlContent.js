import{illegalArgument}from"./errors.js";import{escapeIcons}from"./iconLabels.js";export class MarkdownString{constructor(e="",t=!1){var n,r,s;if(this.value=e,"string"!==typeof this.value)throw illegalArgument("value");"boolean"===typeof t?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=null!==(n=t.isTrusted)&&void 0!==n?n:void 0,this.supportThemeIcons=null!==(r=t.supportThemeIcons)&&void 0!==r&&r,this.supportHtml=null!==(s=t.supportHtml)&&void 0!==s&&s)}appendText(e,t=0){return this.value+=escapeMarkdownSyntaxTokens(this.supportThemeIcons?escapeIcons(e):e).replace(/([ \t]+)/g,((e,t)=>"&nbsp;".repeat(t.length))).replace(/\>/gm,"\\>").replace(/\n/g,1===t?"\\\n":"\n\n"),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+="\n```",this.value+=e,this.value+="\n",this.value+=t,this.value+="\n```\n",this}}export function isEmptyMarkdownString(e){return isMarkdownString(e)?!e.value:!Array.isArray(e)||e.every(isEmptyMarkdownString)}export function isMarkdownString(e){return e instanceof MarkdownString||!(!e||"object"!==typeof e)&&("string"===typeof e.value&&("boolean"===typeof e.isTrusted||void 0===e.isTrusted)&&("boolean"===typeof e.supportThemeIcons||void 0===e.supportThemeIcons))}export function escapeMarkdownSyntaxTokens(e){return e.replace(/[\\`*_{}[\]()#+\-!]/g,"\\$&")}export function removeMarkdownEscapes(e){return e?e.replace(/\\([\\`*_{}[\]()#+\-.!])/g,"$1"):e}export function parseHrefAndDimensions(e){const t=[],n=e.split("|").map((e=>e.trim()));e=n[0];const r=n[1];if(r){const e=/height=(\d+)/.exec(r),n=/width=(\d+)/.exec(r),s=e?e[1]:"",o=n?n[1]:"",i=isFinite(parseInt(o)),p=isFinite(parseInt(s));i&&t.push(`width="${o}"`),p&&t.push(`height="${s}"`)}return{href:e,dimensions:t}}