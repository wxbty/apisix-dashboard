import{$}from"../../dom.js";function removeFromParent(e){try{e.parentElement&&e.parentElement.removeChild(e)}catch(t){}}export class RowCache{constructor(e){this.renderers=e,this.cache=new Map}alloc(e){let t=this.getTemplateCache(e).pop();if(!t){const r=$(".monaco-list-row"),o=this.getRenderer(e),a=o.renderTemplate(r);t={domNode:r,templateId:e,templateData:a}}return t}release(e){e&&this.releaseRow(e)}releaseRow(e){const{domNode:t,templateId:r}=e;t&&(t.classList.remove("scrolling"),removeFromParent(t));const o=this.getTemplateCache(r);o.push(e)}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach(((e,t)=>{for(const r of e){const e=this.getRenderer(t);e.disposeTemplate(r.templateData),r.templateData=null}})),this.cache.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}